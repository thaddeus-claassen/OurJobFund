{% extends 'base.html' %}

{% load staticfiles %}
{% block import %}
    <link rel="stylesheet" type="text/css" href="{% static 'user/css/account.css' %}" />
    <script type="text/javascript" src="{% static 'user/js/account.js' %}" ></script>
{% endblock %}

{% block content %}
<div class="row">
    <div class="col-md-6 col-md-offset-3">
        <form id="username_form" action="{{ request.get_full_path }}" method="POST">
            {% csrf_token %}
            {% if change_username_form %}
            <div class="row">
                <div class="col-md-4">
                    {{ change_username_form.username.label }}
                </div>
                <div class="col-md-4">
                    {{ change_username_form.username }}
                </div>
                <div class="col-md-4">
                    {% if change_username_form %} 
                    <input id="change_username" class="edit" type="button" value="Change Username" />
                    <input id="save_username" class="edit" type="submit" value="Save" name="change-username" />
                    <input id="cancel_username" class="edit" type="button" value="Cancel" />
                    {% endif %}
                </div>
            </div>
            {% if change_username_form.errors %}
            <div class="row">
                <div class="col-md-12">
                    {{ change_username_form.error_list }}
                </div>
            </div>
            {% endif %}
            <div class="row">
                <div class="col-md-12">
                    <span id="change-username-note">Note: Your username cannot be changed more than once every 180 days.</span>
                </div>
            </div>
            {% else %}
            <div class="row">
                <div class="col-md-4"><label id="username-label" for="username">Username</label></div>
                <div class="col-md-4"><input id="username" value="{{ request.user.username }}" /></div>
                <div class="col-md-4"></div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <span id="change-username-note">Note: You can change your username in {{ next_time_username_can_be_changed }} days.</span>
                </div>
            </div>
            {% endif %}
        </form>
        <form id="change_email_form" action="{{ request.get_full_path }}" method="POST">
            {% csrf_token %}
            <div class="row">
                <div class="col-md-4">
                    {{ change_email_form.email.label }}
                </div>
                <div class="col-md-4">
                    {{ change_email_form.email }}
                </div>
                <div class="col-md-4">
                    <input id="change_email" class="edit" type="button" value="Change Email" />
                    <input id="save_email" class="edit" type="submit" value="Save" name="change-email" />
                    <input id="cancel_email" class="edit" type="button" value="Cancel" />
                </div>
            </div>
        </form>
        <form id="password_form" action="{{ request.get_full_path }}" method="POST">
        {% csrf_token %}
        {% for field in change_password_form %}
            <div class="row">
                <div class="col-md-4">
                    {{ field.label }}
                </div>
                <div class="col-md-4">
                    {{ field }}
                </div>
                {% if field.auto_id == 'id_repeat_new_password' %}
                <div class="col-md-4">
                    <input id="change_password" class="edit" type="button" value="Change Password" />
                    <input id="save_password" class="edit" type="submit" value="Save" name="change-password" />
                    <input id="cancel_password" class="edit" type="button" value="Cancel" />
                </div>
                {% endif %}
            </div>
            {% if field.errors %}
            <div class="row">
                <div class="col-md-12">
                    {{ field.errors }}
                </div>
            </div>
            {% endif %}
        {% endfor %}
        </form>
    </div>   
</div>
{% endblock %}
