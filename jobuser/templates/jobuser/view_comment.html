{% extends 'navbar.html' %}

{% load staticfiles %}
{% block importTwo %}
    <link rel="stylesheet" type="text/css" href="{% static 'jobuser/CSS/view_comment.css' %}" />
    <script type="text/javascript" src="{% static 'jobuser/JavaScript/view_update_or_comment.js' %}" ></script>
    <script type="text/javascript" src="{% static 'jobuser/JavaScript/view_comment.js' %}" ></script>
{% endblock %}

{% block content %}
<input id="comment_id" type="hidden" value="{{ comment.id }}" />
<div class="container">
    <div class="row">
        <div class="col-md-12">
            {% if comment.update %}
                <a href="{% url 'jobuser:view_update' comment.update.id %}">{{ comment.update.title }}</a>
            {% else %}
                <a href="{% url 'jobuser:view_update' comment.id %}">Here</a>
            {% endif %}
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            Commented: {{ comment.commented }}
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            {% if comment.imageupload.image %}
                {{ comment.imageupload.image }}
            {% else %}
                No images
            {% endif %}
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            By: {{ comment.commenter.username }}
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
           Is complaint: {{ comment.is_complaint }}
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            Comment: {{ comment.description }}
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            {% if user.is_authenticated and user_is_working_on_job %}
                <input id="write_a_comment" type="button" value="Write a Comment" />
            {% endif %}
            <div id="write_comment_modal" class="modal">
                <div class="modal-header">
                    <span class="close_modal">&times;</span>
                    <h2>Write a Comment</h2>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-12">
                            <label for="add_image">Add optional image:</label>
                            <input id="add_image" type="file" accept="image/*">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <span>Is complaint:</span>
                            <label for="is_complaint_no">No:</label>
                            <input id="is_complaint_no" type="radio" name="is_complaint" value="n" />
                            <label for="is_complaint_yes">Yes:</label>
                            <input id="is_complaint_yes" type="radio" name="is_complaint" value="y" />
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <label for="comment_textarea">Comment:</label>
                            <textarea id="comment_textarea"></textarea>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <input id="publish_comment" type="button" value="Publish Comment" />
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            <table>
                {% for sub_comment in comment.comment_set.all %}
                    <tr>
                        <td>User: {{ sub_comment.commenter.username }}</td>
                        <td>Written: {{ sub_comment.commented }}</td>
                        <td>Is Complaint: {{ sub_comment.is_complaint }}</td>
                        <td>
                            {% if sub_comment.comment_set.all %}
                                Further Comments on this: <a href="{% url 'jobuser:view_comment' sub_comment.id %}">{{ sub_comment.comment_set.count }} in total</a>
                            {% else %}
                                <a href="{% url 'jobuser:view_comment' sub_comment.id %}">There are no further comments.</a>
                            {% endif %}
                        </td>
                    </tr>
                {% empty %}
                    <tr><td>There are no comments.</td></tr>
                {% endfor %}
            </table>
        </div>
    </div>
</div>
{% endblock %}
